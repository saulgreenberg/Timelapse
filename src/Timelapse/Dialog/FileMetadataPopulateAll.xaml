<?xml version="1.0" encoding="utf-8"?>
<dialog:FileMetadataPopulateBase
    x:Class="Timelapse.Dialog.FileMetadataPopulateAll"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="clr-namespace:Timelapse.Controls"
    xmlns:dialog="clr-namespace:Timelapse.Dialog"
    xmlns:toolkit="clr-namespace:TimelapseWpf.Toolkit;assembly=TimelapseWpf.Toolkit"
    mc:Ignorable="d"
    Title="Populate a data field with metadata"
    MinHeight="600" MinWidth="768"
    Height="856" Width="840"
    ResizeMode="CanResizeWithGrip"
    ShowInTaskbar="False"
    WindowStartupLocation="CenterOwner"
    Loaded="Window_Loaded"
    Closing="Window_Closing">

    <Grid>
        <DockPanel Grid.Row="0">

            <toolkit:FormattedMessageContent x:Name="PopulateAllMessage" DockPanel.Dock="Top"
                            Icon="{x:Static toolkit:DialogIconType.Question}"
                            DialogTitle="Populate Data Fields with Selected Metadata"
                            What="Images often embed metadata, some of which may be useful to capture as data.[br]You can direct Timelapse on how to populate data fields with metadata."
                            Solution="Match the desired metadata to a data field to populate those data fields for all your currently selected files.
[ni] Inspect the current file's metadata (and its example value) to see if your files contain metadata of interest.
[ni] For each metadata of interest, use the drop-down menu to select which data field should be populated with the metadata's value.
[ni] If Timelapse was previously used to export data as image metadata, clicking [e]Assign XMP-TimelapseData[/e] will automatically select any matching data fields. Metadata group will be resorted to display those fields.
[ni] Click the [e]Populate[/e] button to apply your metadata selections to all your currently selected files."
                            Hint="[li]Try both inspection tools: [e]ExifTool[/e] is much better at finding all metadata fields, but [e]MetadataExtractor[/e] is much faster if you have many files.
                                  [li] Be patient! It does take time to do this (especially with [e]ExifTool[/e]) if you have a large number of files."
                            Result="Each file's data fields will be populated with each file's metadata values for the selected metadata fields ."
                            ShowExplanationVisibility="True" />

            <DockPanel LastChildFill="True" >
                <StackPanel Orientation="Vertical" DockPanel.Dock="Top" VerticalAlignment="Stretch" Margin="10,0,10,0">
                    <Rectangle Fill="#FF868686" Height="2" />
                </StackPanel>
                <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal" HorizontalAlignment="Right">
                    <RadioButton x:Name="SkipIfNoMetadata"
                                 Content="Skip"
                                 GroupName="MetadataWriteGroup"
                                 IsChecked="True"
                                 VerticalAlignment="Center"
                                 Margin="10,0,5,0"
                                 Checked="MetadataWriteRadioButton_Changed"/>
                    <RadioButton x:Name="ClearIfNoMetadata"
                                 Content="Clear"
                                 GroupName="MetadataWriteGroup"
                                 IsChecked="False"
                                 VerticalAlignment="Center"
                                 Margin="5,0,5,0"
                                 Checked="MetadataWriteRadioButton_Changed"/>
                    <TextBlock Name ="TBSkipClearLabel" Text="the data field if the metadata value cannot be written"
                               VerticalAlignment="Center"
                               Margin="0,0,50,0"/>
                    <Button x:Name="BackButton" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Padding="10" Margin="10,10,10,10" Visibility="Collapsed" Click="Back_Click">_Back</Button>
                    <Button x:Name="CancelButton" IsCancel="True" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Padding="10" Margin="10,10,10,10" Click="CancelButton_Click">_Cancel</Button>
                    <Button x:Name="PreviewButton" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Padding="10" Margin="10,10,10,10" IsEnabled="False" Click="Preview_Click">P_review</Button>
                    <Button x:Name="StartDoneButton" IsDefault="True" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Padding="10" Margin="10,10,10,10"  IsEnabled="False" Click="Start_Click">_Populate</Button>
                </StackPanel>

                <controls:FileMetadataGrid x:Name="MetadataGrid"  DockPanel.Dock="Top" VerticalAlignment="Stretch"/>
                <Grid Name="FeedbackPanel" Visibility="Collapsed" DockPanel.Dock="Top">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <StackPanel Grid.Column="0" Grid.Row="0" Orientation="Horizontal" Margin="10,10,10,0">
                        <TextBlock Name="PopulatingMessage"  Text="--"
                                   FontWeight="Bold"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Left" />
                        <RadioButton Name="OnlyShowIssuesRadioButton"
                                     Content="Only show issues"
                                     GroupName="FeedbackDisplayGroup"
                                     IsChecked="True"
                                     VerticalAlignment="Center"
                                     Margin="20,0,0,0"
                                     Checked="FeedbackDisplayRadioButton_Changed"/>
                        <RadioButton Name="ShowEverythingRadioButton"
                                     Content="Show everything"
                                     GroupName="FeedbackDisplayGroup"
                                     IsChecked="False"
                                     VerticalAlignment="Center"
                                     Margin="10,0,0,0"
                                     Checked="FeedbackDisplayRadioButton_Changed"/>
                    </StackPanel>
                    <DataGrid Name="FeedbackGrid"
                        Grid.Column="0" Grid.Row="1"
                        Margin="0,0,10,0" ColumnWidth="*" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                        SelectionUnit="FullRow" SelectionMode="Single"
                        AutoGenerateColumns="True" AutoGeneratedColumns="FeedbackDatagrid_AutoGeneratedColumns" />
                </Grid>
            </DockPanel>
        </DockPanel>
        <controls:BusyCancelIndicator x:Name="BusyCancelIndicator" IsBusy="False" Grid.Row="0" CancelClick="CancelAsyncOperationButton_Click"/>
    </Grid>
</dialog:FileMetadataPopulateBase>

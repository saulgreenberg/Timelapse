<!--***********************************************************************************

   Toolkit for WPF

   Copyright (C) 2007-2019 Xceed Software Inc.

   This program is provided to you under the terms of the Microsoft Public
   License (Ms-PL) as published at https://opensource.org/license/ms-pl-html

   Fork origin: https://github.com/dotnetprojects/WpfExtendedToolkit
   - based on: https://github.com/xceedsoftware/wpftoolkit, Version 3
   This fork: modified for use in Timelapse project
    by Saul Greenberg, 2025 onwards




  **********************************************************************************-->

<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:TimelapseWpf.Toolkit">

  <!-- Timelapse standard colors -->
  <SolidColorBrush x:Key="TextBoxBorder" Color="LightBlue" />
  <SolidColorBrush x:Key="TextBox_Focused" Color="Blue" />
  <SolidColorBrush x:Key="TextBox_DisabledBorder" Color="#ADB2B5" />
  <SolidColorBrush x:Key="TextBox_DisabledBackground" Color="#F4F4F4" />

  <!-- Timelapse standard border thicknesses -->
  <Thickness x:Key="BorderThickness_Normal">1</Thickness>
  <Thickness x:Key="BorderThickness_Highlight">3</Thickness>

  <DataTemplate x:Key="DefaultImprintTemplate">
    <ContentControl Content="{Binding}"
                    Foreground="Gray"
                    Focusable="False"
                    IsHitTestVisible="False" />
  </DataTemplate>

  <Style x:Key="ImprintTextBox"
         TargetType="{x:Type local:ImprintTextBox}">
    <Setter Property="Foreground"
            Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
    <Setter Property="Background"
            Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
    <Setter Property="BorderBrush"
            Value="{StaticResource TextBoxBorder}" />
    <Setter Property="BorderThickness"
            Value="{StaticResource BorderThickness_Normal}" />
    <Setter Property="Padding"
            Value="3" />
    <Setter Property="AllowDrop"
            Value="true" />
    <Setter Property="FocusVisualStyle"
            Value="{x:Null}" />
    <Setter Property="ScrollViewer.PanningMode"
            Value="VerticalFirst" />
    <Setter Property="Stylus.IsFlicksEnabled"
            Value="False" />
    <Setter Property="ImprintTemplate"
            Value="{StaticResource DefaultImprintTemplate}" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type local:ImprintTextBox}">
          <Grid>

            <Border x:Name="Border"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    CornerRadius="1"
                    Background="{TemplateBinding Background}">
              <Grid Background="Transparent">
                <!-- Imprint on bottom layer (visually behind, hit-tested last) -->
                <ContentPresenter x:Name="PART_ImprintHost"
                                  Content="{TemplateBinding Imprint}"
                                  ContentTemplate="{Binding ImprintTemplate, RelativeSource={RelativeSource TemplatedParent}, TargetNullValue={StaticResource DefaultImprintTemplate}}"
                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                  Margin="{TemplateBinding Padding}"
                                  Visibility="Collapsed"
                                  Panel.ZIndex="0" />
                <!-- ScrollViewer on top layer (visually on top, hit-tested first) - MUST be last child for proper hit-testing -->
                <ScrollViewer x:Name="PART_ContentHost"
                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                              Panel.ZIndex="1" />
              </Grid>
            </Border>

          </Grid>
          <ControlTemplate.Triggers>
            <!-- Imprint visibility is fully controlled by code-behind (ShowImprint + HideOnFocus logic) -->
            <Trigger Property="IsFocused"
                     Value="True">
              <Setter TargetName="Border"
                      Property="BorderThickness"
                      Value="{StaticResource BorderThickness_Highlight}" />
              <Setter TargetName="Border"
                      Property="BorderBrush"
                      Value="{StaticResource TextBox_Focused}" />
            </Trigger>
            <Trigger Property="IsEnabled"
                     Value="false">
              <Setter Property="Foreground"
                      Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style TargetType="{x:Type local:ImprintTextBox}"
         BasedOn="{StaticResource ImprintTextBox}" />

</ResourceDictionary>
